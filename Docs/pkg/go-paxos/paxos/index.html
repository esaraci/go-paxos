<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="theme-color" content="#375EAB">

  <title>paxos - The Go Programming Language</title>

<link type="text/css" rel="stylesheet" href="../../../lib/godoc/style.css">


<script>window.initFuncs = [];</script>

<script src="../../../lib/godoc/jquery.js" defer></script>



<script>var goVersion = "go1.12.4";</script>
<script src="../../../lib/godoc/godocs.js" defer></script>
</head>
<body>

<div id='lowframe' style="position: fixed; bottom: 0; left: 0; height: 0; width: 100%; border-top: thin solid grey; background-color: white; overflow: auto;">
...
</div><!-- #lowframe -->

<div id="topbar" class="wide"><div class="container">
<div class="top-heading" id="heading-wide"><a href="http://localhost:6060/">The Go Programming Language</a></div>
<div class="top-heading" id="heading-narrow"><a href="http://localhost:6060/">Go</a></div>
<a href="index.html#" id="menu-button"><span id="menu-button-arrow">&#9661;</span></a>
<form method="GET" action="http://localhost:6060/search">
<div id="menu">
<a href="http://localhost:6060/doc/">Documents</a>
<a href="http://localhost:6060/pkg/">Packages</a>
<a href="http://localhost:6060/project/">The Project</a>
<a href="http://localhost:6060/help/">Help</a>

<a href="http://localhost:6060/blog/">Blog</a>


<span class="search-box"><input type="search" id="search" name="q" placeholder="Search" aria-label="Search" required><button type="submit"><span><!-- magnifying glass: --><svg width="24" height="24" viewBox="0 0 24 24"><title>submit search</title><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/><path d="M0 0h24v24H0z" fill="none"/></svg></span></button></span>
</div>
</form>

</div></div>



<div id="page" class="wide">
<div class="container">


  <h1>
    Package paxos
    <span class="text-muted"></span>
  </h1>







<div id="nav"></div>


<!--
	Copyright 2009 The Go Authors. All rights reserved.
	Use of this source code is governed by a BSD-style
	license that can be found in the LICENSE file.
-->
<!--
	Note: Static (i.e., not template-generated) href and id
	attributes start with "pkg-" to make it impossible for
	them to conflict with generated attributes (some of which
	correspond to Go identifiers).
-->

	<script>
	document.ANALYSIS_DATA = null;
	document.CALLGRAPH = null;
	</script>

	
		
		<div id="short-nav">
			<dl>
			<dd><code>import "go-paxos/paxos"</code></dd>
			</dl>
			<dl>
			<dd><a href="index.html#pkg-overview" class="overviewLink">Overview</a></dd>
			<dd><a href="index.html#pkg-index" class="indexLink">Index</a></dd>
			
			
				<dd><a href="index.html#pkg-subdirectories">Subdirectories</a></dd>
			
			</dl>
		</div>
		<!-- The package's Name is printed as title by the top-level template -->
		<div id="pkg-overview" class="toggleVisible">
			<div class="collapsed">
				<h2 class="toggleButton" title="Click to show Overview section">Overview ▹</h2>
			</div>
			<div class="expanded">
				<h2 class="toggleButton" title="Click to hide Overview section">Overview ▾</h2>
				<p>
Package paxos implements the main components of the Paxos distributed consensus algorithm.
</p>

				
			</div>
		</div>

		<div id="pkg-index" class="toggleVisible">
		<div class="collapsed">
			<h2 class="toggleButton" title="Click to show Index section">Index ▹</h2>
		</div>
		<div class="expanded">
			<h2 class="toggleButton" title="Click to hide Index section">Index ▾</h2>

		<!-- Table of contents for API; must be named manual-nav to turn off auto nav. -->
			<div id="manual-nav">
			<dl>
			
			
			
				
				<dd><a href="index.html#AddContentTypeJson">func AddContentTypeJson(w *http.ResponseWriter)</a></dd>
			
				
				<dd><a href="index.html#ComputeNewValuesRequest">func ComputeNewValuesRequest() messages.NewValuesRequest</a></dd>
			
				
				<dd><a href="index.html#ComputeNewValuesResponse">func ComputeNewValuesResponse(newValuesRequest messages.NewValuesRequest) messages.NewValuesResponse</a></dd>
			
				
				<dd><a href="index.html#EnableCors">func EnableCors(w *http.ResponseWriter)</a></dd>
			
				
				<dd><a href="index.html#GetLearntValue">func GetLearntValue(turnID int) messages.GenericMessage</a></dd>
			
				
				<dd><a href="index.html#ReceiveAccept">func ReceiveAccept(acceptRequest messages.GenericMessage) messages.GenericMessage</a></dd>
			
				
				<dd><a href="index.html#ReceiveLearn">func ReceiveLearn(learnRequest messages.GenericMessage) messages.GenericMessage</a></dd>
			
				
				<dd><a href="index.html#ReceivePrepare">func ReceivePrepare(prepareRequest messages.GenericMessage) messages.GenericMessage</a></dd>
			
				
				<dd><a href="index.html#ResponseHasLearntValue">func ResponseHasLearntValue(responseMessage messages.GenericMessage) bool</a></dd>
			
				
				<dd><a href="index.html#SendAccept">func SendAccept(turnID int, seq int, v string) (messageToUser string)</a></dd>
			
				
				<dd><a href="index.html#SendLearn">func SendLearn(turnID int, v string) string</a></dd>
			
				
				<dd><a href="index.html#SendPrepare">func SendPrepare(turnID int, seq int, v string) (messageToUser string)</a></dd>
			
				
				<dd><a href="index.html#SendSeek">func SendSeek()</a></dd>
			
				
				<dd><a href="index.html#ToJson">func ToJson(i interface{}) string</a></dd>
			
			
			
			</dl>
			</div><!-- #manual-nav -->

		

		
			<h3>Package files</h3>
			<p>
			<span style="font-size:90%">
			
				<a href="http://localhost:6060/src/go-paxos/paxos/acceptor.go">acceptor.go</a>
			
				<a href="http://localhost:6060/src/go-paxos/paxos/learner.go">learner.go</a>
			
				<a href="http://localhost:6060/src/go-paxos/paxos/proposer.go">proposer.go</a>
			
				<a href="http://localhost:6060/src/go-paxos/paxos/seeker.go">seeker.go</a>
			
				<a href="http://localhost:6060/src/go-paxos/paxos/utils.go">utils.go</a>
			
			</span>
			</p>
		
		</div><!-- .expanded -->
		</div><!-- #pkg-index -->

		

		
		
		
			
			
			<h2 id="AddContentTypeJson">func <a href="http://localhost:6060/src/go-paxos/paxos/utils.go?s=3059:3106#L79">AddContentTypeJson</a>
				<a class="permalink" href="index.html#AddContentTypeJson">&#xb6;</a>
				
				
			</h2>
			<pre>func AddContentTypeJson(w *<a href="http://localhost:6060/pkg/net/http/">http</a>.<a href="http://localhost:6060/pkg/net/http/#ResponseWriter">ResponseWriter</a>)</pre>
			<p>
AddContentTypeJson adds the content type header to responses.
</p>

			
			

		
			
			
			<h2 id="ComputeNewValuesRequest">func <a href="http://localhost:6060/src/go-paxos/paxos/seeker.go?s=7123:7179#L138">ComputeNewValuesRequest</a>
				<a class="permalink" href="index.html#ComputeNewValuesRequest">&#xb6;</a>
				
				
			</h2>
			<pre>func ComputeNewValuesRequest() <a href="messages/index.html">messages</a>.<a href="messages/index.html#NewValuesRequest">NewValuesRequest</a></pre>
			<p>
TODO: change docs, from today 26/12/19 ComputeNewValuesRequest will return and empty &#34;missing&#34; field, i.e. it will only ask for new (higher) values
TODO: no need to perform any changes when receiving (i.e. inside ComputeNewValuesResponse) since an empty &#34;missing&#34; does not raise any problem
ComputeNewValuesRequest computes the list of turn ids needed by the askForNewValues function.
One component of the request is the last turn id learnt (last when sorted, i.e. the highest). The other component is a list of &#39;missing&#39; turn ids.
The list is computed starting from 1 and going to the last id. If an element is not found in neither one of the two tables (proposal, learnt) then it&#39;s added to the list.
e.g.
</p>
<pre>Turn IDs in &#39;proposal&#39; table --&gt; 	P = [1, 2, 5, 6, 10]
Turn IDs in &#39;learnt&#39; table --&gt; 		P = [1, 2, 8]

The message we send will have lastID = 7, missing = [3, 4, 7]
</pre>
<p>
5, 6 are not included since they are dangling proposals and will be handled by askForDanglingProposals.
any value higher than 8 (9, 10) is currently ignored, but if any node has info about any proposal with turnID &gt; 8 it will let us know since we told them what our highest turn id was.
</p>

			
			

		
			
			
			<h2 id="ComputeNewValuesResponse">func <a href="http://localhost:6060/src/go-paxos/paxos/seeker.go?s=8600:8700#L179">ComputeNewValuesResponse</a>
				<a class="permalink" href="index.html#ComputeNewValuesResponse">&#xb6;</a>
				
				
			</h2>
			<pre>func ComputeNewValuesResponse(newValuesRequest <a href="messages/index.html">messages</a>.<a href="messages/index.html#NewValuesRequest">NewValuesRequest</a>) <a href="messages/index.html">messages</a>.<a href="messages/index.html#NewValuesResponse">NewValuesResponse</a></pre>
			<p>
ComputeNewValuesResponse returns a NewValuesResponse message containing a amp with values to be learned by the requester.
This function is only triggered when a node sends a NewValuesRequest.
</p>

			
			

		
			
			
			<h2 id="EnableCors">func <a href="http://localhost:6060/src/go-paxos/paxos/utils.go?s=3212:3251#L84">EnableCors</a>
				<a class="permalink" href="index.html#EnableCors">&#xb6;</a>
				
				
			</h2>
			<pre>func EnableCors(w *<a href="http://localhost:6060/pkg/net/http/">http</a>.<a href="http://localhost:6060/pkg/net/http/#ResponseWriter">ResponseWriter</a>)</pre>
			<p>
EnableCors allows requests from anywhere.
</p>

			
			

		
			
			
			<h2 id="GetLearntValue">func <a href="http://localhost:6060/src/go-paxos/paxos/learner.go?s=333:388#L2">GetLearntValue</a>
				<a class="permalink" href="index.html#GetLearntValue">&#xb6;</a>
				
				
			</h2>
			<pre>func GetLearntValue(turnID <a href="http://localhost:6060/pkg/builtin/#int">int</a>) <a href="messages/index.html">messages</a>.<a href="messages/index.html#GenericMessage">GenericMessage</a></pre>
			<p>
GetLearntValue returns a message with the &#39;learnt&#39; field containing the value (@v) of the proposal with turn ID = @turnID.
If the requested turn ID does not exist, the &#39;learnt&#39; field will contain an empty string.
</p>

			
			

		
			
			
			<h2 id="ReceiveAccept">func <a href="http://localhost:6060/src/go-paxos/paxos/acceptor.go?s=5990:6071#L117">ReceiveAccept</a>
				<a class="permalink" href="index.html#ReceiveAccept">&#xb6;</a>
				
				
			</h2>
			<pre>func ReceiveAccept(acceptRequest <a href="messages/index.html">messages</a>.<a href="messages/index.html#GenericMessage">GenericMessage</a>) <a href="messages/index.html">messages</a>.<a href="messages/index.html#GenericMessage">GenericMessage</a></pre>
			<p>
ReceiveAccept implements the acceptor&#39;s behaviour when receiving an accept request.
This function compares the stored proposal (@oldP) against the
proposal received as input (@newP) and returns an &#34;accept&#34; when
@newP is strictly higher or equal to @oldP, otherwise it returns a &#34;decline&#34; message.
In both cases @oldP (which might be null) is appended to the final response message.
In some cases the acceptor might notice that a value has already been learnt
for the requested proposal, in that case this information will also be appended to the response message.
This function is very similar to ReceivePrepare, the distinction is made just to avoid multiple small if-else clauses.
</p>

			
			

		
			
			
			<h2 id="ReceiveLearn">func <a href="http://localhost:6060/src/go-paxos/paxos/learner.go?s=1121:1200#L22">ReceiveLearn</a>
				<a class="permalink" href="index.html#ReceiveLearn">&#xb6;</a>
				
				
			</h2>
			<pre>func ReceiveLearn(learnRequest <a href="messages/index.html">messages</a>.<a href="messages/index.html#GenericMessage">GenericMessage</a>) <a href="messages/index.html">messages</a>.<a href="messages/index.html#GenericMessage">GenericMessage</a></pre>
			<p>
ReceiveLearn implements the learner&#39;s behaviour when receiving a learn request.
If the proposed value has not been learnt yet it gets learnt immediately and learn requests with that value are sent to each known node.
If the proposed value has already been learnt then no action is performed.
If we get a proposal to learn a value which is different from the value we already have for that turn id
</p>

			
			

		
			
			
			<h2 id="ReceivePrepare">func <a href="http://localhost:6060/src/go-paxos/paxos/acceptor.go?s=2510:2593#L39">ReceivePrepare</a>
				<a class="permalink" href="index.html#ReceivePrepare">&#xb6;</a>
				
				
			</h2>
			<pre>func ReceivePrepare(prepareRequest <a href="messages/index.html">messages</a>.<a href="messages/index.html#GenericMessage">GenericMessage</a>) <a href="messages/index.html">messages</a>.<a href="messages/index.html#GenericMessage">GenericMessage</a></pre>
			<p>
ReceivePrepare implements the acceptor&#39;s behaviour when receiving a prepare request.
This function compares the stored proposal (@oldP) against the
proposal received as input (@newP) and returns a &#34;promise&#34; when
@newP is STRICTLY higher than @oldP, otherwise it returns a &#34;retry&#34; message.
In both cases @oldP (which might be null) is appended to the final response message.
In some cases the acceptor might notice that a value has already been learnt
for the requested proposal, in that case this information will also be appended to the response message.
This function is very similar to ReceiveAccept, the distinction is made just to avoid multiple small if-else clauses.
</p>

			
			

		
			
			
			<h2 id="ResponseHasLearntValue">func <a href="http://localhost:6060/src/go-paxos/paxos/utils.go?s=2388:2461#L61">ResponseHasLearntValue</a>
				<a class="permalink" href="index.html#ResponseHasLearntValue">&#xb6;</a>
				
				
			</h2>
			<pre>func ResponseHasLearntValue(responseMessage <a href="messages/index.html">messages</a>.<a href="messages/index.html#GenericMessage">GenericMessage</a>) <a href="http://localhost:6060/pkg/builtin/#bool">bool</a></pre>
			<p>
ResponseHasLearntValue checks whether the response contains a non empty string in the &#39;learnt&#39; field.
If that is true it means that the responding node has already learnt a value for the current turn id.
</p>

			
			

		
			
			
			<h2 id="SendAccept">func <a href="http://localhost:6060/src/go-paxos/paxos/proposer.go?s=17155:17224#L360">SendAccept</a>
				<a class="permalink" href="index.html#SendAccept">&#xb6;</a>
				
				
			</h2>
			<pre>func SendAccept(turnID <a href="http://localhost:6060/pkg/builtin/#int">int</a>, seq <a href="http://localhost:6060/pkg/builtin/#int">int</a>, v <a href="http://localhost:6060/pkg/builtin/#string">string</a>) (messageToUser <a href="http://localhost:6060/pkg/builtin/#string">string</a>)</pre>
			<p>
SendAccept sends an accept request to all the acceptors in the network, the values of the accept request are agreed upon during the prepare request, if @v is empty a default value will be assigned to it.
SendAccept should only be called when it is right to do so, i.e. when the prepare request was &#34;promised&#34; by a majority of nodes.
Calling this function outside the normal flow of the algorithm does not guarantee the correctness of the system.
Note that when the node is working in AUTOMATIC mode, this function is called automatically after reaching the quorum for the prepare request.
</p>

			
			

		
			
			
			<h2 id="SendLearn">func <a href="http://localhost:6060/src/go-paxos/paxos/proposer.go?s=18805:18848#L406">SendLearn</a>
				<a class="permalink" href="index.html#SendLearn">&#xb6;</a>
				
				
			</h2>
			<pre>func SendLearn(turnID <a href="http://localhost:6060/pkg/builtin/#int">int</a>, v <a href="http://localhost:6060/pkg/builtin/#string">string</a>) <a href="http://localhost:6060/pkg/builtin/#string">string</a></pre>
			<p>
SendLearn sends an learn request to all the acceptors in the network, the value of the learn request are the values agreed upon during the accept request.
Note that when the node is working in AUTOMATIC mode, this function is called automatically after reaching the quorum for the accept request.
</p>

			
			

		
			
			
			<h2 id="SendPrepare">func <a href="http://localhost:6060/src/go-paxos/paxos/proposer.go?s=14810:14880#L310">SendPrepare</a>
				<a class="permalink" href="index.html#SendPrepare">&#xb6;</a>
				
				
			</h2>
			<pre>func SendPrepare(turnID <a href="http://localhost:6060/pkg/builtin/#int">int</a>, seq <a href="http://localhost:6060/pkg/builtin/#int">int</a>, v <a href="http://localhost:6060/pkg/builtin/#string">string</a>) (messageToUser <a href="http://localhost:6060/pkg/builtin/#string">string</a>)</pre>
			<p>
SendPrepare sends a prepare request to all the acceptors in the network, the values of the prepare request are to be provided by the user (except @v which can remain empty).
</p>

			
			

		
			
			
			<h2 id="SendSeek">func <a href="http://localhost:6060/src/go-paxos/paxos/seeker.go?s=2135:2150#L44">SendSeek</a>
				<a class="permalink" href="index.html#SendSeek">&#xb6;</a>
				
				
			</h2>
			<pre>func SendSeek()</pre>
			<p>
SendSeek calls the function askForDanglingProposals and askForNewValues. Both of those aim to achieve eventual consistency.
</p>

			
			

		
			
			
			<h2 id="ToJson">func <a href="http://localhost:6060/src/go-paxos/paxos/utils.go?s=2893:2926#L73">ToJson</a>
				<a class="permalink" href="index.html#ToJson">&#xb6;</a>
				
				
			</h2>
			<pre>func ToJson(i interface{}) <a href="http://localhost:6060/pkg/builtin/#string">string</a></pre>
			<p>
ToJson is used to marshal interfaces into a valid json string.
</p>

			
			

		
		
	

	





	
	
		<h2 id="pkg-subdirectories">Subdirectories</h2>
	
	<div class="pkg-dir">
		<table>
			<tr>
				<th class="pkg-name">Name</th>
				<th class="pkg-synopsis">Synopsis</th>
			</tr>

			
			<tr>
				<td colspan="2"><a href="../index.html">..</a></td>
			</tr>
			

			
				<tr>
				
					<td class="pkg-name" style="padding-left: 0px;">
						<a href="config/index.html">config</a>
					</td>
				
					<td class="pkg-synopsis">
						Package config exposes some static variables loaded through a .yaml file used throughout the Paxos algorithm.
					</td>
				</tr>
			
				<tr>
				
					<td class="pkg-name" style="padding-left: 0px;">
						<a href="messages/index.html">messages</a>
					</td>
				
					<td class="pkg-synopsis">
						Package messages exposes some of the structures used for internal communication.
					</td>
				</tr>
			
				<tr>
				
					<td class="pkg-name" style="padding-left: 0px;">
						<a href="proposal/index.html">proposal</a>
					</td>
				
					<td class="pkg-synopsis">
						Package proposal exposes the Proposal type and some of its methods.
					</td>
				</tr>
			
				<tr>
				
					<td class="pkg-name" style="padding-left: 0px;">
						<a href="queries/index.html">queries</a>
					</td>
				
					<td class="pkg-synopsis">
						Package queries implements all the queries needed by this specific implementation of the Paxos algorithm.
					</td>
				</tr>
			
		</table>
	</div>



<div id="footer">
Build version go1.12.4.<br>
Except as <a href="https://developers.google.com/site-policies#restrictions">noted</a>,
the content of this page is licensed under the
Creative Commons Attribution 3.0 License,
and code is licensed under a <a href="http://localhost:6060/LICENSE">BSD license</a>.<br>
<a href="http://localhost:6060/doc/tos.html">Terms of Service</a> |
<a href="http://www.google.com/intl/en/policies/privacy/">Privacy Policy</a>
</div>

</div><!-- .container -->
</div><!-- #page -->

</body>
</html>

